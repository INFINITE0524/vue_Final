import{u as B,r as l,f as N,c as i,a as e,t as p,w as L,v as O,b as d,n as y,F as S,g as V,d as _,o as u,h as D}from"./index-bJfqvb7K.js";import{a as v}from"./axios-BimPEqV4.js";const F={id:"todoListPage",class:"bg-half"},I={class:"todo_sm"},M={href:"javascript:;"},P={class:"conatiner todoListPage vhContainer"},E={class:"todoList_Content"},U={class:"inputBox"},j={key:0,class:"todoList_list"},R={class:"todoList_tab"},q={class:"todoList_items"},G={class:"todoList_item"},H={class:"todoList_label"},J=["checked","onClick"],K=["onClick"],Q={class:"todoList_statistics"},W={key:0},X={key:1},Y={key:1,class:"text-align-center"},st={__name:"TodoView",setup(Z){const $=B(),n=l(""),r=l("https://todolist-api.hexschool.io"),g=l(""),a=l(),c=l([]),h=l(""),w=l(!1),m=l({id:"",createTime:0,content:"",status:!1});async function C(){try{n.value=document.cookie.replace(/(?:(?:^|.*;\s*)maxToken\s*\=\s*([^;]*).*$)|^.*$/,"$1");const o=`${r.value}/users/checkout`,t=await v.get(o,{headers:{Authorization:n.value}});t.status==200&&(g.value=t.data,w.value=!0,status.value="signIn")}catch(o){console.log("Token檢查失敗",o)}}async function f(){const o=`${r.value}/todos/`;try{const t=await v.get(o,{headers:{Authorization:n.value}});t.status==200&&(c.value=t.data.data)}catch(t){console.log("取得TodoList失敗",t)}}async function T(){if(h.value==""){alert("代辦事項不得空白");return}const o=`${r.value}/todos/`;try{const t=await v.post(o,{content:h.value},{headers:{Authorization:n.value}});h.value=""}catch(t){alert("新增代辦事項失敗",t)}await f()}async function x(o){const t=`${r.value}/todos/${o}`;try{const s=await v.delete(t,{headers:{Authorization:n.value}})}catch(s){console.log("刪除失敗",s)}m.value={},await f()}async function z(o){const t=`${r.value}/todos/${o}/toggle`;try{const s=await v.patch(t,{},{headers:{Authorization:n.value}})}catch(s){console.log("更新toggle失敗",s)}await f()}function k(o){a.value=o}async function b(){const o=`${r.value}/users/sign_out`;try{const t=await v.post(o,{},{headers:{Authorization:n.value}});$.push("/")}catch(t){alert(t)}}return N(async()=>{await C(),w.value?await f():$.push("/")}),(o,t)=>(u(),i("div",F,[e("nav",null,[t[6]||(t[6]=e("h1",null,[e("a",{href:"#"},"ONLINE TODO LIST")],-1)),e("ul",null,[e("li",I,[e("a",M,[e("span",null,p(g.value?`${g.value.nickname}的代辦`:"尚未登入"),1)])]),e("li",null,[e("a",{href:"#loginPage",onClick:t[0]||(t[0]=s=>b())},"登出")])])]),e("div",P,[e("div",E,[e("div",U,[L(e("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":t[1]||(t[1]=s=>h.value=s)},null,512),[[O,h.value]]),e("a",{href:"#",onClick:t[2]||(t[2]=d(s=>T(),["prevent"]))},t[7]||(t[7]=[e("i",{class:"fa fa-plus"},null,-1)]))]),c.value.length>0?(u(),i("div",j,[e("ul",R,[e("li",null,[e("a",{href:"#",onClick:t[3]||(t[3]=d(s=>k(),["prevent"])),class:y({active:a.value==null})},"全部",2)]),e("li",null,[e("a",{href:"#",onClick:t[4]||(t[4]=d(s=>k(!1),["prevent"])),class:y({active:a.value==!1})},"待完成",2)]),e("li",null,[e("a",{href:"#",onClick:t[5]||(t[5]=d(s=>k(!0),["prevent"])),class:y({active:a.value==!0})},"已完成",2)])]),e("div",q,[e("ul",G,[(u(!0),i(S,null,V(c.value,s=>L((u(),i("li",{key:s.id},[e("label",H,[e("input",{class:"todoList_input",type:"checkbox",value:"true",checked:s.status,onClick:d(A=>z(s.id),["prevent"])},null,8,J),e("span",null,p(s.content),1)]),e("a",{href:"#",onClick:d(A=>x(s.id),["prevent"])},t[8]||(t[8]=[e("i",{class:"fa-solid fa-trash-can"},null,-1)]),8,K)])),[[D,a.value==null?!0:a.value==s.status]])),128))]),e("div",Q,[a.value==null||a.value==!0?(u(),i("p",W,p(c.value.filter(s=>s.status==!0).length)+" 個完成項目 ",1)):_("",!0),a.value==null||a.value==!1?(u(),i("p",X,p(c.value.filter(s=>s.status==!1).length)+" 個未完成項目 ",1)):_("",!0)])])])):_("",!0),c.value.length==0?(u(),i("div",Y,t[9]||(t[9]=[e("p",null,"目前尚無代辦事項",-1)]))):_("",!0)])])]))}};export{st as default};
